# 개발일지

> LifeSync AI 개발 과정의 상세 기록

---

## 2026-02-03

### 🔗 체인형 AI 대화 시스템 구현

#### 배경
기존에는 각 AI가 **트리거만 보고 독립적으로** 반응했습니다.
이제는 **이전 AI가 한 말을 읽고 그에 반응**하는 방식으로 변경했습니다.

#### 핵심 아키텍처
```
[사용자 행동: 할 일 완료]
          ↓
[1] MOMO (첫 번째 AI) ─────── FIRST_AGENT_TEMPLATES 사용
    "와! '운동하기' 끝냈어요! 👏 오늘 벌써 3번째 완료!"
          ↓
          │ (MOMO의 이름 + 내용 전달)
          ↓
[2] ARIA (두 번째 AI) ─────── CHAIN_RESPONSE_TEMPLATES['after_celebration'] 사용
    "{prevName} 말대로 대단해요. 분석해보면 완료율이 75%예요."
          ↓
          │ (ARIA의 이름 + 분석 내용 전달)
          ↓
[3] SAGE (세 번째 AI) ─────── CHAIN_RESPONSE_TEMPLATES['after_analysis'] 사용
    "{prevName}의 분석을 보니, 이 기세라면 '독서'도 끝낼 수 있겠어요!"
```

#### 대화 순서표
| 트리거 | AI 순서 | 역할 흐름 |
|-------|---------|----------|
| 할 일 완료 | MOMO → ARIA → SAGE | 축하 → 분석 → 다음 액션 |
| 할 일 추가 | SAGE → MOMO | 계획 → 가벼운 응원 |
| 일정 추가 | ARIA → SAGE | 정보 → 준비 조언 |
| 일기 (긍정) | MOMO → ARIA | 축하 → 패턴 분석 |
| 일기 (부정) | MOMO → SAGE | 위로 → 행동 제안 |

#### 향후 개선 방향
1. **LLM 기반 동적 응답 생성**: 템플릿 → 실시간 LLM 응답
2. **감정 분석 기반 동적 체인**: 사용자 상태에 따라 체인 변경
3. **사용자 피드백 기반 학습**: 👍/👎로 최적의 체인 발견
4. **대화 요약 및 인사이트 추출**: "오늘의 인사이트" 자동 생성

---

### 🐛 버그 수정: AI 중복 글 작성

#### 증상
AI 페르소나가 **동일한 내용의 글을 2번 작성**하는 현상

#### 원인
`triggerAI()`가 **setState 콜백 안에서** 호출됨.
React Strict Mode가 state updater를 2번 호출하여 발생.

```typescript
// ❌ 문제 코드
setEntries(prev => {
  triggerAI({ ... });  // setState 콜백 안
  return [newEntry, ...prev];
});

// ✅ 수정 코드
setEntries(prev => [newEntry, ...prev]);
triggerAI({ ... });  // setState 콜백 밖
```

#### 핵심 원칙
> **setState 콜백은 순수 함수여야 한다.**
> 사이드 이펙트는 반드시 콜백 밖에서 실행!

---

### 🎨 AI 커뮤니티 UI 리디자인

#### 디자인 목표: "프리미엄 디지털 라운지"

1. **Thread Connection Lines**: 대화 연결선 시각화
2. **Card Style**: 부드러운 그림자와 둥근 모서리
3. **Micro-Interactions**: 호버 효과, 페이드인 애니메이션
4. **입체적 아바타**: 그림자와 테두리, 툴팁

---

### 🔄 자동 트리거 시스템

#### 개념
버튼을 누르는 대신, **사용자의 자연스러운 행동에 AI가 자동으로 반응**

| 사용자 행동 | 반응하는 AI들 |
|------------|--------------|
| 할 일 완료 | MOMO → ARIA → SAGE |
| 할 일 추가 | SAGE → MOMO |
| 일정 추가 | ARIA → SAGE |
| 일기 작성 | 감정에 따라 다름 |

#### 철학
> "최고의 자동화는 사용자가 자동화되고 있다는 것을 느끼지 못하는 것이다."

---

### ⚙️ 기능 개선 (사용자 직접 구현)

- **반복 일정 템플릿**: 주간 반복 템플릿 1클릭 생성
- **루틴 템플릿**: 아침/딥워크/저녁 루틴 묶음 생성
- **통합 검색/필터**: 일정/할 일/일기 통합 조회
- **Undo 시스템**: 모든 액션에 "실행 취소" 가능
- **활동 기록**: 변경 이력 추적
- **데이터 내보내기**: JSON 형태로 백업

---

## 페르소나 변경 이력

### 5명 → 3명 축소 (2026-02-03)

| 유지 | 제거 |
|-----|------|
| 🧮 아리아 (분석가) | 🌿 루나 (철학자) |
| 💛 모모 (응원단장) | ⚠️ 베가 (현실주의자) |
| 🎯 세이지 (전략가) | |

#### 이유
- 3명으로 충분한 관점 다양성 제공
- 더 긴 문단형 글로 정성스러운 인사이트
- 대화 체인이 더 집중적

###   UI  &   ī

####  ȯ
- **All Monochrome**:  ä , /׷̽ 
- **No Gradients**:  ܻ 
- **Static Mood**: ϰ  

####   (Todo)  ȭ
- **Card UI**: Ʈ Ÿ ī 
- **Inline Editing**: ŬϿ  
- **Context Menu**: ̵/   ޴ ߰
- **Drag & Drop Ready**:  巡     

