# 페르소나 채팅 구현 (Persona Chat Implementation)

## 개요
채팅 뷰 내에서 AI 페르소나를 선택하고, 해당 페르소나의 성격에 맞춰 대화할 수 있는 기능을 구현했습니다. 또한 대화 모드(기본, 롤플레잉, 학습)를 선택하여 상호작용 방식을 변경할 수 있습니다.

## 변경 사항

### 1. 앱 상태 관리 (`App.tsx`)
- 현재 채팅에 선택된 페르소나를 추적하기 위해 `activeChatAgentId` 상태를 추가했습니다.
- `activeChatAgentId`를 로컬 스토리지에 저장하여 유지되도록 했습니다.
- `activeChatAgentId`, `setActiveChatAgentId` 및 전체 `agents` 목록을 `ChatView`에 전달했습니다.
- **페르소나 선택 시 새로운 대화 세션이 생성되도록 로직을 수정했습니다.**

### 2. 채팅 인터페이스 (`views/ChatView.tsx`)
- `ChatViewProps`에 `agents` 목록과 `onSelectAgent` 핸들러를 추가했습니다.
- **상단 바 리디자인**:
  - 페르소나 선택기를 **좌측 상단**에 배치하고 전체 너비를 사용하도록 변경했습니다.
  - 페르소나 목록 옆에 **채팅 모드 선택기(기본, 롤플레잉, 학습)**를 추가했습니다.
  - 깔끔한 디자인을 위해 이중 프레임 테두리를 제거했습니다.
- **채팅 모드**:
  - **기본**: 표준 AI 비서 모드입니다.
  - **롤플레잉**: 캐릭터에 완전히 몰입하여 AI임을 드러내지 않고 연기합니다.
  - **학습**: 튜터 모드로, 개념을 친절하게 설명하고 이해도를 확인하는 질문을 합니다.
- 채팅 인터페이스에서 어시스턴트 메시지에 선택된 에이전트의 아바타가 표시됩니다.
- `generateChatResponse` 호출 시 다음 정보를 포함하도록 업데이트했습니다:
  - 선택된 `agent` (페르소나)
  - 선택된 `chatMode` (대화 모드)

### 3. AI 서비스 (`services/geminiService.ts`)
- `generateChatResponse`가 다음 매개변수를 받도록 업데이트했습니다:
  - `agent` (선택 사항)
  - `mode` (선택 사항, 기본값 'basic')
- 시스템 프롬프트 생성 시 다음 정보를 포함하도록 수정했습니다:
  - 에이전트의 이름, 역할, 성격, 말투
  - **모드별 지침**:
    - *롤플레잉*: "제4의 벽을 깨지 말고 캐릭터에 몰입하세요."
    - *학습*: "튜터로서 행동하고 이해했는지 확인하세요."
- 이를 통해 AI가 선택된 페르소나와 대화 모드에 맞춰 적절하게 행동하게 됩니다.

## 사용 방법
1. "AI 채팅" 탭으로 이동합니다.
2. 좌측 상단에서 **AI 페르소나**를 선택합니다.
3. 페르소나 옆에서 **대화 모드**(기본, 롤플레잉, 학습)를 선택합니다.
4. AI가 선택된 페르소나와 모드의 조합에 맞춰 응답합니다.
