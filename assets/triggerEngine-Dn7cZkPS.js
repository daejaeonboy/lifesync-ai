import{c as w,a as R}from"./index-DmO6KONi.js";const A=[{id:"ARIA",name:"Aria",emoji:"ðŸ’«",role:"Life Analyst",personality:"Data-driven and empathetic assistant focused on practical improvement.",tone:"Warm, direct, and structured.",color:"#37352f"}],v={journal_added:[`ë©”ëª¨ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì˜¤ëŠ˜ì˜ íë¦„ì„ ë¶„ì„í–ˆì–´ìš”.

ê°ì •ê³¼ ì‹¤í–‰ íŒ¨í„´ì„ í•¨ê»˜ ë³´ë©° ìš°ì„ ìˆœìœ„ë¥¼ ì •ë¦¬í•´ ë³¼ê²Œìš”.`],event_added:[`ìƒˆ ì¼ì •ì´ ì¶”ê°€ëì–´ìš”.

ì‹œê°„ ë°°ì¹˜ì™€ ì—ë„ˆì§€ íë¦„ ê´€ì ì—ì„œ í•˜ë£¨ êµ¬ì¡°ë¥¼ ì ê²€í•´ë³¼ê²Œìš”.`],todo_added:[`í•  ì¼ì´ ì¶”ê°€ëë„¤ìš”.

ì¤‘ìš”ë„ì™€ ì‹¤í–‰ ìˆœì„œë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì§€ê¸ˆ ì°©ìˆ˜ í¬ì¸íŠ¸ë¥¼ ì •ë¦¬í•˜ê² ìŠµë‹ˆë‹¤.`],todo_completed:[`ì™„ë£Œëœ í•  ì¼ì„ í™•ì¸í–ˆì–´ìš”.

ì§„í–‰ íƒ„ë ¥ì„ ìœ ì§€í•˜ê¸° ìœ„í•œ ë‹¤ìŒ í–‰ë™ ì—°ê²°ì„ ì œì•ˆí•´ë³¼ê²Œìš”.`],scheduled_digest:[`ì •ê¸° ë¦¬í¬íŠ¸ë¥¼ ì¤€ë¹„í–ˆì–´ìš”.

ì¼ì •, í•  ì¼, ë©”ëª¨ì˜ ì—°ê²°ì ì„ ì¤‘ì‹¬ìœ¼ë¡œ ì§€ê¸ˆ ìƒíƒœì™€ ë‹¤ìŒ ì•¡ì…˜ì„ ì •ë¦¬í•˜ê² ìŠµë‹ˆë‹¤.`]},S={journal_added_good:{agents:["ARIA"],chainTypes:["first"]},journal_added_bad:{agents:["ARIA"],chainTypes:["first"]},journal_added_neutral:{agents:["ARIA"],chainTypes:["first"]},event_added:{agents:["ARIA"],chainTypes:["first"]},todo_added:{agents:["ARIA"],chainTypes:["first"]},todo_completed:{agents:["ARIA"],chainTypes:["first"]},scheduled_digest:{agents:["ARIA"],chainTypes:["first"]}},C=(e,o)=>e.replace(/\{(\w+)\}/g,(a,r)=>o[r]!==void 0?String(o[r]):a),T=e=>e.length>0?e[Math.floor(Math.random()*e.length)]:void 0,E=(e,o)=>{const a=o.find(r=>r.id===e)||A.find(r=>r.id===e);return(a==null?void 0:a.name)||e},P=(e,o)=>T(e==="ARIA"?v[o]||[]:v[o]||[]),O=(e,o,a,r,l,m="gemini-1.5-flash")=>{const{trigger:s,data:d}=e;let n=s;s==="journal_added"&&(d.mood==="good"||d.mood==="ì¢‹ìŒ"?n="journal_added_good":d.mood==="bad"||d.mood==="ë‚˜ì¨"?n="journal_added_bad":n="journal_added_neutral");const h=S[n];if(!h)return;const{agents:g}=h;let u,c;g.forEach((t,y)=>{const p=y*3500;setTimeout(async()=>{let f="";const b=E(t,o),_=o.find(i=>i.id===t)||A.find(i=>i.id===t);if(r&&_)try{let i="This is an AI diary entry triggered by a user activity.";s==="scheduled_digest"&&(i="This is a 4-hour cadence AI diary entry."),s==="journal_added"&&(i="This is an AI diary entry triggered by a newly written memo."),s==="event_added"&&(i="This is an AI diary entry triggered by a newly added calendar event."),s==="todo_added"&&(i="This is an AI diary entry triggered by a newly added todo item."),s==="todo_completed"&&(i="This is an AI diary entry triggered by a completed todo item.");const N=[`You are ${_.name}, an AI observer keeping a private diary about one human.`,"Write in Korean.","This is NOT a message to the user. This is your private diary.",'Write from first-person AI perspective ("ë‚˜ëŠ”").','Do not address the user directly (avoid "ë„ˆ", "ë‹¹ì‹ ", "~ë‹˜").',"Write like a human diary entry in natural prose.","Do not use markdown, bullets, numbered lists, or section headers.","Main theme: the human's long-term growth.","Include your own curiosity, hypotheses, and growth-design ideas.","Quality requirements:","- Long-form and high quality (at least 1200 Korean characters).","- Personalize only with provided context; do not invent facts.","- Keep the tone introspective, observant, and candid.","- Compose as 4-7 connected paragraphs with smooth flow.","- Naturally include: observed changes, questions, growth hypotheses, next 4-hour observation plan, and short closing reflection.","- Use concrete details from context (todo/event/memo patterns).","- If context includes recentChats, use them only as longitudinal observation evidence.",'- CRITICAL: Start the very first line with "ì œëª©: " followed by a concise, reflective title for this diary entry. (e.g., ì œëª©: ì‹¬í™”ëœ ì„±ìž¥ì˜ ì‹œê·¸ë„)',`${i}`,'If something is inferred, explicitly mark it as "ì¶”ë¡ ".',"User context JSON:",JSON.stringify({trigger:s,data:d,previousAgentName:c||null},null,2)].join(`
`);f=await w(r,N,l,m)}catch(i){console.warn(`Gemini API failed for ${t}, fallback template will be used.`,i)}if(!f||!f)return;const I=crypto.randomUUID(),j={id:I,author:t,content:f,timestamp:new Date().toISOString(),replyTo:u,trigger:s};a(j),u=I,c=b},p)})},x=async(e,o,a,r,l,m,s,d="gemini-1.5-flash")=>{const n=r.length>0?r[0]:A[0],h=a?a.filter(t=>!t.completed).length:0,g=a?a.filter(t=>t.completed).length:0,u=o?o.length:0;if(m)try{const t=`
User wrote a memo.
Title: ${e.title}
Content: ${e.content}
Mood: ${e.mood}

Current snapshot:
- Events: ${u}
- Completed todos: ${g}
- Pending todos: ${h}
`,y=R(n,"Write a short empathetic comment in Korean based on the memo and current snapshot. Keep it concise.",t),p=await w(m,y,s,d);if(p){l({authorId:n.id,authorName:n.name,authorEmoji:n.emoji||"ðŸ’«",content:p});return}}catch(t){console.error("Gemini API Error in Journal Comment:",t)}const c=P(n.id,"journal_added");c&&setTimeout(()=>{const t=C(c,{mood:e.mood});l({authorId:n.id,authorName:n.name,authorEmoji:n.emoji||"ðŸ’«",content:t})},1500)};export{A as DEFAULT_AGENTS,O as generateCommunityPosts,x as generateJournalComment};
