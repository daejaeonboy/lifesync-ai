import{c as w,a as S}from"./index-D9bT0MLL.js";const A=[{id:"ARIA",name:"Aria",emoji:"ðŸ’«",role:"Life Analyst",personality:"Data-driven and empathetic assistant focused on practical improvement.",tone:"Warm, direct, and structured.",color:"#37352f"}],I={journal_added:[`ë©”ëª¨ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì˜¤ëŠ˜ì˜ íë¦„ì„ ë¶„ì„í–ˆì–´ìš”.

ê°ì •ê³¼ ì‹¤í–‰ íŒ¨í„´ì„ í•¨ê»˜ ë³´ë©° ìš°ì„ ìˆœìœ„ë¥¼ ì •ë¦¬í•´ ë³¼ê²Œìš”.`],scheduled_digest:[`ì •ê¸° ë¦¬í¬íŠ¸ë¥¼ ì¤€ë¹„í–ˆì–´ìš”.

ì¼ì •, í•  ì¼, ë©”ëª¨ì˜ ì—°ê²°ì ì„ ì¤‘ì‹¬ìœ¼ë¡œ ì§€ê¸ˆ ìƒíƒœì™€ ë‹¤ìŒ ì•¡ì…˜ì„ ì •ë¦¬í•˜ê² ìŠµë‹ˆë‹¤.`]},E={journal_added_good:{agents:["ARIA"],chainTypes:["first"]},journal_added_bad:{agents:["ARIA"],chainTypes:["first"]},journal_added_neutral:{agents:["ARIA"],chainTypes:["first"]},scheduled_digest:{agents:["ARIA"],chainTypes:["first"]}},R=(e,o)=>e.replace(/\{(\w+)\}/g,(r,a)=>o[a]!==void 0?String(o[a]):r),T=e=>e.length>0?e[Math.floor(Math.random()*e.length)]:void 0,P=(e,o)=>{const r=o.find(a=>a.id===e)||A.find(a=>a.id===e);return(r==null?void 0:r.name)||e},$=(e,o)=>T(e==="ARIA"?I[o]||[]:I[o]||[]),O=(e,o,r,a,l,m="gemini-1.5-flash")=>{const{trigger:i,data:s}=e;let n=i;i==="journal_added"&&(s.mood==="good"||s.mood==="ì¢‹ìŒ"?n="journal_added_good":s.mood==="bad"||s.mood==="ë‚˜ì¨"?n="journal_added_bad":n="journal_added_neutral");const u=E[n];if(!u)return;const{agents:g}=u;let h,c;g.forEach((t,y)=>{const p=y*3500;setTimeout(async()=>{let f="";const j=P(t,o),_=o.find(d=>d.id===t)||A.find(d=>d.id===t);if(a&&_)try{const d=i==="scheduled_digest"?"This is a 4-hour cadence AI diary entry.":"This is an AI diary entry triggered by a newly written memo.",b=[`You are ${_.name}, an AI observer keeping a private diary about one human.`,"Write in Korean.","This is NOT a message to the user. This is your private diary.",'Write from first-person AI perspective ("ë‚˜ëŠ”").','Do not address the user directly (avoid "ë„ˆ", "ë‹¹ì‹ ", "~ë‹˜").',"Write like a human diary entry in natural prose.","Do not use markdown, bullets, numbered lists, or section headers.","Main theme: the human's long-term growth.","Include your own curiosity, hypotheses, and growth-design ideas.","Quality requirements:","- Long-form and high quality (at least 1200 Korean characters).","- Personalize only with provided context; do not invent facts.","- Keep the tone introspective, observant, and candid.","- Compose as 4-7 connected paragraphs with smooth flow.","- Naturally include: observed changes, questions, growth hypotheses, next 4-hour observation plan, and short closing reflection.","- Use concrete details from context (todo/event/memo patterns).",`${d}`,'If something is inferred, explicitly mark it as "ì¶”ë¡ ".',"User context JSON:",JSON.stringify({trigger:i,data:s,previousAgentName:c||null},null,2)].join(`
`);f=await w(a,b,l,m)}catch(d){console.warn(`Gemini API failed for ${t}, fallback template will be used.`,d)}if(!f||!f)return;const v=crypto.randomUUID(),N={id:v,author:t,content:f,timestamp:new Date().toISOString(),replyTo:h,trigger:i};r(N),h=v,c=j},p)})},D=async(e,o,r,a,l,m,i,s="gemini-1.5-flash")=>{const n=a.length>0?a[0]:A[0],u=r?r.filter(t=>!t.completed).length:0,g=r?r.filter(t=>t.completed).length:0,h=o?o.length:0;if(m)try{const t=`
User wrote a memo.
Title: ${e.title}
Content: ${e.content}
Mood: ${e.mood}

Current snapshot:
- Events: ${h}
- Completed todos: ${g}
- Pending todos: ${u}
`,y=S(n,"Write a short empathetic comment in Korean based on the memo and current snapshot. Keep it concise.",t),p=await w(m,y,i,s);if(p){l({authorId:n.id,authorName:n.name,authorEmoji:n.emoji||"ðŸ’«",content:p});return}}catch(t){console.error("Gemini API Error in Journal Comment:",t)}const c=$(n.id,"journal_added");c&&setTimeout(()=>{const t=R(c,{mood:e.mood});l({authorId:n.id,authorName:n.name,authorEmoji:n.emoji||"ðŸ’«",content:t})},1500)};export{A as DEFAULT_AGENTS,O as generateCommunityPosts,D as generateJournalComment};
