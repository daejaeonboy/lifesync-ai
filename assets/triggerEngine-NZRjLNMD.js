import{c as b,a as S}from"./index-nh0Cdkil.js";const A=[{id:"ARIA",name:"Aria",emoji:"ðŸ’«",role:"Life Analyst",personality:"Data-driven and empathetic assistant focused on practical improvement.",tone:"Warm, direct, and structured.",color:"#37352f"}],T={journal_added:[`ë©”ëª¨ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì˜¤ëŠ˜ì˜ íë¦„ì„ ë¶„ì„í–ˆì–´ìš”.

ê°ì •ê³¼ ì‹¤í–‰ íŒ¨í„´ì„ í•¨ê»˜ ë³´ë©° ìš°ì„ ìˆœìœ„ë¥¼ ì •ë¦¬í•´ ë³¼ê²Œìš”.`],event_added:[`ìƒˆ ì¼ì •ì´ ì¶”ê°€ëì–´ìš”.

ì‹œê°„ ë°°ì¹˜ì™€ ì—ë„ˆì§€ íë¦„ ê´€ì ì—ì„œ í•˜ë£¨ êµ¬ì¡°ë¥¼ ì ê²€í•´ë³¼ê²Œìš”.`],todo_added:[`í•  ì¼ì´ ì¶”ê°€ëë„¤ìš”.

ì¤‘ìš”ë„ì™€ ì‹¤í–‰ ìˆœì„œë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì§€ê¸ˆ ì°©ìˆ˜ í¬ì¸íŠ¸ë¥¼ ì •ë¦¬í•˜ê² ìŠµë‹ˆë‹¤.`],todo_completed:[`ì™„ë£Œëœ í•  ì¼ì„ í™•ì¸í–ˆì–´ìš”.

ì§„í–‰ íƒ„ë ¥ì„ ìœ ì§€í•˜ê¸° ìœ„í•œ ë‹¤ìŒ í–‰ë™ ì—°ê²°ì„ ì œì•ˆí•´ë³¼ê²Œìš”.`],chat_message:[`ëŒ€í™” ë‚´ìš©ì„ ë°˜ì˜í•´ í˜„ìž¬ ì§‘ì¤‘ ì£¼ì œë¥¼ ì—…ë°ì´íŠ¸í–ˆì–´ìš”.

ì•žìœ¼ë¡œì˜ ì„ íƒì´ ë” ì„ ëª…í•´ì§€ë„ë¡ ê´€ì°° í¬ì¸íŠ¸ë¥¼ ì •ë¦¬í•´ë‘˜ê²Œìš”.`],scheduled_digest:[`ì •ê¸° ë¦¬í¬íŠ¸ë¥¼ ì¤€ë¹„í–ˆì–´ìš”.

ì¼ì •, í•  ì¼, ë©”ëª¨ì˜ ì—°ê²°ì ì„ ì¤‘ì‹¬ìœ¼ë¡œ ì§€ê¸ˆ ìƒíƒœì™€ ë‹¤ìŒ ì•¡ì…˜ì„ ì •ë¦¬í•˜ê² ìŠµë‹ˆë‹¤.`]},C={journal_added_good:{agents:["ARIA"],chainTypes:["first"]},journal_added_bad:{agents:["ARIA"],chainTypes:["first"]},journal_added_neutral:{agents:["ARIA"],chainTypes:["first"]},event_added:{agents:["ARIA"],chainTypes:["first"]},todo_added:{agents:["ARIA"],chainTypes:["first"]},todo_completed:{agents:["ARIA"],chainTypes:["first"]},chat_message:{agents:["ARIA"],chainTypes:["first"]},scheduled_digest:{agents:["ARIA"],chainTypes:["first"]}};let v=0;const E=(e,n)=>e.replace(/\{(\w+)\}/g,(i,s)=>n[s]!==void 0?String(n[s]):i),w=e=>e.length>0?e[Math.floor(Math.random()*e.length)]:void 0,P=(e,n)=>{const i=n.find(s=>s.id===e)||A.find(s=>s.id===e);return(i==null?void 0:i.name)||e},$=(e,n)=>w(e==="ARIA"?T[n]||[]:T[n]||[]),D=(e,n,i,s,h,u="gemini-1.5-flash")=>{const{trigger:o,data:d}=e;if(o==="chat_message"){if(String((d==null?void 0:d.text)||"").trim().length<8)return;const c=Date.now(),l=120*1e3;if(c-v<l)return;v=c}let r=o;o==="journal_added"&&(d.mood==="good"||d.mood==="ì¢‹ìŒ"?r="journal_added_good":d.mood==="bad"||d.mood==="ë‚˜ì¨"?r="journal_added_bad":r="journal_added_neutral");const g=C[r];if(!g)return;const{agents:y}=g;let f,m;y.forEach((t,c)=>{const l=c*3500;setTimeout(async()=>{let p="";const j=P(t,n),_=n.find(a=>a.id===t)||A.find(a=>a.id===t);if(s&&_)try{let a="This is an AI diary entry triggered by a user activity.";o==="scheduled_digest"&&(a="This is a 4-hour cadence AI diary entry."),o==="journal_added"&&(a="This is an AI diary entry triggered by a newly written memo."),o==="event_added"&&(a="This is an AI diary entry triggered by a newly added calendar event."),o==="todo_added"&&(a="This is an AI diary entry triggered by a newly added todo item."),o==="todo_completed"&&(a="This is an AI diary entry triggered by a completed todo item."),o==="chat_message"&&(a="This is an AI diary entry triggered by a recent user chat message.");const N=[`You are ${_.name}, an AI observer keeping a private diary about one human.`,"Write in Korean.","This is NOT a message to the user. This is your private diary.",'Write from first-person AI perspective ("ë‚˜ëŠ”").','Do not address the user directly (avoid "ë„ˆ", "ë‹¹ì‹ ", "~ë‹˜").',"Write like a human diary entry in natural prose.","Do not use markdown, bullets, numbered lists, or section headers.","Main theme: the human's long-term growth.","Include your own curiosity, hypotheses, and growth-design ideas.","Quality requirements:","- Long-form and high quality (at least 1200 Korean characters).","- Personalize only with provided context; do not invent facts.","- Keep the tone introspective, observant, and candid.","- Compose as 4-7 connected paragraphs with smooth flow.","- Naturally include: observed changes, questions, growth hypotheses, next 4-hour observation plan, and short closing reflection.","- Use concrete details from context (todo/event/memo patterns).",'- CRITICAL: Start the very first line with "ì œëª©: " followed by a concise, reflective title for this diary entry. (e.g., ì œëª©: ì‹¬í™”ëœ ì„±ìž¥ì˜ ì‹œê·¸ë„)',`${a}`,'If something is inferred, explicitly mark it as "ì¶”ë¡ ".',"User context JSON:",JSON.stringify({trigger:o,data:d,previousAgentName:m||null},null,2)].join(`
`);p=await b(s,N,h,u)}catch(a){console.warn(`Gemini API failed for ${t}, fallback template will be used.`,a)}if(!p||!p)return;const I=crypto.randomUUID(),R={id:I,author:t,content:p,timestamp:new Date().toISOString(),replyTo:f,trigger:o};i(R),f=I,m=j},l)})},O=async(e,n,i,s,h,u,o,d="gemini-1.5-flash")=>{const r=s.length>0?s[0]:A[0],g=i?i.filter(t=>!t.completed).length:0,y=i?i.filter(t=>t.completed).length:0,f=n?n.length:0;if(u)try{const t=`
User wrote a memo.
Title: ${e.title}
Content: ${e.content}
Mood: ${e.mood}

Current snapshot:
- Events: ${f}
- Completed todos: ${y}
- Pending todos: ${g}
`,c=S(r,"Write a short empathetic comment in Korean based on the memo and current snapshot. Keep it concise.",t),l=await b(u,c,o,d);if(l){h({authorId:r.id,authorName:r.name,authorEmoji:r.emoji||"ðŸ’«",content:l});return}}catch(t){console.error("Gemini API Error in Journal Comment:",t)}const m=$(r.id,"journal_added");m&&setTimeout(()=>{const t=E(m,{mood:e.mood});h({authorId:r.id,authorName:r.name,authorEmoji:r.emoji||"ðŸ’«",content:t})},1500)};export{A as DEFAULT_AGENTS,D as generateCommunityPosts,O as generateJournalComment};
